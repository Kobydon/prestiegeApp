<div class="page">

  <div class="row" *blockUI="'loading'">
    <div class="col-12">

      <div class="card report-card">
        <div class="card-body">

          <!-- Header -->
          <div class="report-header">
            <div>
              <h5 class="mb-1">Income Payments</h5>
              <small class="text-muted">
                Total Payments: <strong>GH₵{{ totalAmount | number }}</strong>
              </small>
            </div>

            <div class="report-actions">
              <input
                type="text"
                class="form-control form-control-sm search-input"
                placeholder="Search payments..."
                id="myInput"
                (keyup)="myFunction()"
              />

              <input
                type="date"
                class="form-control form-control-sm"
                formControlName="dates"
                (ngModelChange)="searchDates()"
              />

              <button class="btn btn-sm btn-primary" (click)="openPopup()">
                <i class="fa fa-plus"></i> Add
              </button>

              <button class="btn btn-sm btn-success" (click)="exportexcel()">
                <i class="fa fa-file-excel-o"></i> Export
              </button>
            </div>
          </div>

          <!-- Table -->
          <div class="table-responsive mt-3">
            <table class="table table-hover align-middle" id="excel-table">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Name</th>
                  <th>Date</th>
                  <th class="text-end">Amount</th>
                  <th>Note</th>
                </tr>
              </thead>

              <tbody>
                <tr
                  *ngFor="let item of incomeList | slice:(page-1)*pageSize:page*pageSize; index as i"
                >
                  <td>{{ i + 1 }}</td>
                  <td>{{ item.name }}</td>
                  <td>{{ item.date }}</td>
                  <td class="text-end fw-bold">
                    GH₵{{ item.amount | number }}
                  </td>
                  <td class="text-muted">{{ item.note }}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Pagination -->
          <div class="d-flex justify-content-end pt-3">
            <ngb-pagination
              [collectionSize]="incomeList.length"
              [pageSize]="pageSize"
              [(page)]="page"
              [maxSize]="5"
              [rotate]="true"
              [boundaryLinks]="true">
            </ngb-pagination>
          </div>

        </div>
      </div>

    </div>
  </div>
  <div
  class="modal custom-modal"
  tabindex="-1"
  role="dialog"
  [ngStyle]="{'display':displayStyle}">
  
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">{{ header }}</h5>
        <i class="fa fa-times close-icon" (click)="closePopup()"></i>
      </div>

      <div class="modal-body">
        <div class="card border-0">
          <div class="card-body">

            <form [formGroup]="createForm" (ngSubmit)="addIncome(createForm.value)">
              <div class="row g-3">

                <div class="col-md-6">
                  <label>Name</label>
                  <input
                    type="text"
                    formControlName="name"
                    class="form-control"
                    placeholder="Enter name">
                </div>

                <div class="col-md-6">
                  <label>Date</label>
                  <input
                    type="date"
                    class="form-control"
                    formControlName="date">
                </div>

                <div class="col-md-6">
                  <label>Amount</label>
                  <input
                    type="text"
                    class="form-control"
                    formControlName="amount">
                </div>

                <div class="col-md-6">
                  <label>Note</label>
                  <textarea
                    rows="3"
                    class="form-control"
                    formControlName="note"></textarea>
                </div>

              </div>

              <div class="text-center mt-4">

                <button
                  *ngIf="header == 'Add New'"
                  type="submit"
                  class="btn btn-primary px-5">
                  Save
                </button>

                <button
                  *ngIf="header == 'Edit'"
                  type="button"
                  class="btn btn-warning px-5"
                  (click)="updateIncome(createForm.value)">
                  Update
                </button>

              </div>
            </form>

          </div>
        </div>
      </div>

    </div>
  </div>
</div>

</div>
